# 年度报告活动的基础框架

## 产品视角框架

> 启动动画（1~3 页）：叙旧前的铺垫，铺垫整体 H5 的风格；
> 重点数据展示（3~5 页）：回忆走马灯，对关键数据做分类、对比、交叉对比，再配上解读；
> 异常数据分析（2~5 页）：寻找“纪念点”，摘录异常数据，包装为“特别的 XXX”；
> 总结概览（1 页）：每个人的专属报表，一年做了啥事，心里想有 X 数；
> 关键词总结（1~2 页）：把报表中每个人最关注的点转化为有趣的语言；
> 传播/活动页（1 页）：报告看完了，也不能白看，该分享分享该转化转化。

## 研发视角框架

> 启动动画
> 数据展示页面
> 总结页面

## 数据来源

一开始我的想法是：服根据特定的算法，然后分别取不同的数据库查询数据，然后通过接口返回；
这种想法是非常错误的，稍微想一下就会知道不合理：这种请求是非常耗时的

其实从这种活动形式就可以看出，所有数据都是产品提前定义好的模板，因此正确的做法是：

1. BI 同学根据产品的需求内容或者根据平台的用户数据的特性，算出所有用户的数据信息
2. 在活动期间，将这些信息存储到特定的数据库给服务端同学查询

## 需要注意的点

1. 做需求之前明确流程：是/否登录，是/否实名，是/否未成年，这些路径都需要考虑好
2. 分享链路的流程确认好（这部分更多的是依赖平时的基建，而不是某一次的活动）
3. 数据脱敏：针对不同的人群，展示该数据是否存在着法律风险，这个需要法务同学确认（特别是未成年群体）

# 技术相关内容

## 活动技术拆分

1. 资源的预加载(图片，音频，视频等等)(**总结活动肯定会使用大量的图片作为效果展示，因此为了体验最好做一个资源的预加载，在资源预加载期间展示 loading 进度条**)
2. 页面切换：react-transition-group 使用这个库完成
3. 动画：文字，div 块，帧动画，lottie

## react-transition-group 页面切换 demo

[demo](./demo/6_%E5%B9%B4%E5%BA%A6%E6%B4%BB%E5%8A%A8%E6%8A%A5%E5%91%8A%E6%80%BB%E7%BB%93/%E5%9F%BA%E6%9C%AC%E9%A1%B5%E9%9D%A2%E8%BF%87%E6%B8%A1%E5%8A%A8%E7%94%BB/src/pages/index.tsx)

支持的功能：

1. 支持页面的切换，同时能够使用 cssTransition 控制动画的各个流程
2. 执行动画期间不允许切换页面

效果图
![](./_images/效果图.gif)

**注意点：这仅仅只是一个 demo,正常的移动端活动还需要进行 touchmove 事件的适配**

## 拓展

如果基建允许的话，可以使用 canvas 进行活动的支持，像 b 站的年度总结活动就是使用 canvas 去做的

# 参考资料

1. [扒了 16 个 APP 的年度报告 H5 后，我发现这几点秘密](http://www.woshipm.com/pd/3315394.html)
2. [支付宝年度账单交互效果的实现](https://blog.csdn.net/wangxs520/article/details/79017194)
3. [一个超级吊的 css 项目](https://github.com/comehope/front-end-daily-challenges)
4. [关于 html：预加载多个音频文件](https://www.codenong.com/31060642/)
5. [html5 video 视频页面内缓存 - 全量加载方法](https://segmentfault.com/a/1190000012893122)
